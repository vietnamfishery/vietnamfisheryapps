<mat-card fxLayout="column">
    <div class="table-header" fxLayout="column" fxLayoutAlign="center center">
        <mat-card-title>
            <h2 class="mat-headline center-align">THÔNG TIN CHUẨN BỊ AO</h2>
        </mat-card-title>
        <mat-card-subtitle>
            <h4 class="subtitle">Nhập chi tiết thông tin chuẩn bị ao của bạn</h4>
        </mat-card-subtitle>
    </div>
    <div fxLayout="row" class="mr-b-5">
        <div fxFlexOffset="10" fxFlex="80" fxFlexOffset.xs="5" fxFlex.xs="90" fxFlexOffset.sm="10" fxFlex.sm="80" fxFlexOffset.md="10" fxFlex.md="80">
            <br>
            <mat-horizontal-stepper [linear]="isLinear" #stepper>
                <mat-step [stepControl]="form">
                    <form [formGroup]="form" style="font-size:20px" enctype="multipart/form-data" fxFlexOffset="20" fxFlex="60">
                        <ng-template matStepLabel>Thông tin chi tiết ao mới</ng-template>
                        <mat-card-content fxLayout="column">
                            <mat-form-field>
                                <input matInput placeholder="Tên ao nuôi" type="text" [formControl]="form.controls['pondName']"
                                    required autocomplete="off">
                            </mat-form-field>
                            <small *ngIf="form.controls['pondName'].hasError('required') && form.controls['pondName'].touched" class="mat-text-warn">Tên ao không được để trống.</small>
                            <div fxLayout="row" fxLayout.sm="column" fxLayout.xs="column" fxLayoutGap="10px"
                                fxLayoutGap.sm="0" fxLayoutGap.xs="0">
                                <mat-form-field fxFlex="100">
                                    <mat-select [(value)]="selected" placeholder="Trạng thái ao" [formControl]="form.controls['status']"
                                        required>
                                        <mat-option>None</mat-option>
                                        <mat-option value={{0}}>Ao trống</mat-option>
                                        <mat-option value={{1}}>Đang nuôi</mat-option>
                                        <mat-option value={{2}}>Đang nâng cấp</mat-option>
                                    </mat-select>
                                </mat-form-field>
                                <mat-form-field fxFlex="100">
                                    <input matInput placeholder="Chi phí tạo ao (vnđ)" type="number" [formControl]="form.controls['createCost']"
                                        required autocomplete="off">
                                </mat-form-field>
                            </div>
                            <div fxLayout="row" fxLayout.sm="column" fxLayout.xs="column" fxLayoutGap="10px"
                                fxLayoutGap.sm="0" fxLayoutGap.xs="0">
                                <div fxFlex="100">
                                    <small *ngIf="form.controls['status'].hasError('required') && form.controls['status'].touched"
                                        class="mat-text-warn">Cần cho biết trạng thái của ao.</small>
                                </div>
                                <div fxFlex="100">
                                    <small *ngIf="form.controls['createCost'].hasError('required') && form.controls['createCost'].touched"
                                        class="mat-text-warn">Chi phí không được để trống.</small>
                                </div>
                            </div>
                            <div fxLayout="row" fxLayout.sm="column" fxLayout.xs="column" fxLayoutGap="10px"
                                fxLayoutGap.sm="0" fxLayoutGap.xs="0">
                                <mat-form-field fxFlex="100">
                                    <input matInput placeholder="Diện tích ao (m2)" type="number" [formControl]="form.controls['pondArea']"
                                        required autocomplete="off">
                                </mat-form-field>
                                <mat-form-field fxFlex="100">
                                    <input matInput placeholder="Độ sâu của ao (m)" type="number" [formControl]="form.controls['pondDepth']"
                                        required autocomplete="off">
                                </mat-form-field>
                            </div>
                            <div fxLayout="row" fxLayout.sm="column" fxLayout.xs="column" fxLayoutGap="10px"
                                fxLayoutGap.sm="0" fxLayoutGap.xs="0">
                                <div fxFlex="100">
                                    <small *ngIf="form.controls['pondArea'].hasError('required') && form.controls['pondArea'].touched"
                                        class="mat-text-warn">Diện tích không được để trống.</small>
                                </div>
                                <div fxFlex="100">
                                    <small *ngIf="form.controls['pondDepth'].hasError('required') && form.controls['pondDepth'].touched"
                                        class="mat-text-warn">Độ sâu không được để trống.</small>
                                </div>
                            </div>
                        </mat-card-content>
                        <hr>
                        <mat-card-actions>
                            <div fxLayout="row" fxLayoutAlign="center center" class="pad">
                                <button mat-raised-button type="submit" color="primary" class="btn-block" [disabled]="form.invalid"
                                    matStepperNext>Tiếp theo</button>
                                <button mat-raised-button color="warn" type="submit" routerLink="/quan-ly-ao">Huỷ</button>
                            </div>
                        </mat-card-actions>
                    </form>
                </mat-step>
                <mat-step [stepControl]="formPondPrepare">
                    <form [formGroup]="formPondPrepare" fxFlexOffset="20" fxFlex="60">
                        <ng-template matStepLabel>Chuẩn bị ao</ng-template>
                        <h5><i>Nhập tên gợi nhắc cho lần chuẩn bị này.</i></h5>
                        <div fxLayout="row" fxLayout.sm="column" fxLayout.xs="column" fxLayoutGap="10px" fxLayoutGap.sm="0"
                            fxLayoutGap.xs="0">
                            <mat-form-field fxFlex="100">
                                <input matInput placeholder="Tên gợi nhắc" type="text" autocomplete="off" required
                                    [formControl]="formPondPrepare.controls['pondPrepareName']">
                            </mat-form-field>
                        </div>
                        <div fxLayout="row" fxLayout.sm="column" fxLayout.xs="column" fxLayoutGap="10px" fxLayoutGap.sm="0"
                            fxLayoutGap.xs="0">
                            <div fxFlex="100">
                                <small *ngIf="formPondPrepare.controls['pondPrepareName'].hasError('required') && formPondPrepare.controls['pondPrepareName'].touched" class="mat-text-warn">Số lượng không được trống.</small>
                            </div>
                        </div>
                        <div fxLayout="row" fxLayoutAlign="end center">
                            <button mat-raised-button matStepperPrevious style="margin-right:5px" color="warn">Trước</button>
                            <button mat-raised-button [disabled]="formPondPrepare.invalid" matStepperNext type="submit" color="primary">Tiếp theo</button>
                        </div>
                    </form>
                </mat-step>
                <mat-step [stepControl]="formDetailPrepare">
                    <form [formGroup]="formDetailPrepare" fxFlexOffset="20" fxFlex="60">
                        <ng-template matStepLabel>Cơ sở vật chất</ng-template>
                        <div fxLayout="row" fxLayout.sm="column" fxLayout.xs="column" fxLayoutGap="10px" fxLayoutGap.sm="0"
                            fxLayoutGap.xs="0">
                            <mat-form-field fxFlex="100">
                                <mat-select [(value)]="selected" placeholder="Nguyên, vật liệu" [formControl]="formDetailPrepare.controls['storage']" required>
                                    <mat-option>None</mat-option>
                                    <mat-option *ngFor="let material of storages" [value]="material">{{ material.productName }}</mat-option>
                                </mat-select>
                            </mat-form-field>
                            <mat-form-field fxFlex="100">
                                <input matInput placeholder="Số lượng" type="number" [formControl]="formDetailPrepare.controls['quantity']" autocomplete="off" required>
                            </mat-form-field>
                        </div>
                        <div fxLayout="row" fxLayout.sm="column" fxLayout.xs="column" fxLayoutGap="10px" fxLayoutGap.sm="0"
                            fxLayoutGap.xs="0">
                            <div fxFlex="100">
                                <small *ngIf="formDetailPrepare.controls['storage'].hasError('required') && formDetailPrepare.controls['storage'].touched" class="mat-text-warn">Nguyên, vật liệu không được trống.</small>
                            </div>
                            <div fxFlex="100">
                                <small *ngIf="formDetailPrepare.controls['quantity'].hasError('required') && formDetailPrepare.controls['quantity'].touched" class="mat-text-warn">Số lượng không được trống.</small>
                            </div>
                        </div>
                        <div fxLayout="row" fxLayoutAlign="end center">
                            <button mat-raised-button type="button" (click)="addArray()" class="mat-green-700" [disabled]="formDetailPrepare.invalid" *ngIf="detailsOfPrepare.length > 0">Tiếp tục thêm</button>
                            <button mat-raised-button type="button" (click)="addArray()" class="mat-green-700" [disabled]="formDetailPrepare.invalid" *ngIf="detailsOfPrepare.length === 0">Thêm</button>
                        </div>
                        <br>
                        <div fxLayout="row" fxLayoutAlign="end center">
                            <button mat-raised-button matStepperPrevious style="margin-right:5px" color="warn">Trước</button>
                            <button mat-raised-button *ngIf="detailsOfPrepare.length > 0" type="button" color="primary" matStepperNext>Tiếp theo</button>
                        </div>
                    </form>
                    <mat-card>
                        <mat-card-header>
                            <mat-card-title>{{ showDetailsOfPrepare.length }} vật phẩm đã chọn <span class="re-choose" (click)="reChoose()">Chọn lại</span> (<span style="color: red">*</span>)</mat-card-title>
                        </mat-card-header>
                        <mat-list *ngIf="showDetailsOfPrepare.length > 0">
                            <mat-list-item *ngFor="let choosen of showDetailsOfPrepare"><b>{{ choosen.productName }}</b>&nbsp;-&nbsp;<span>{{ choosen.quantity }}</span></mat-list-item>
                        </mat-list>
                    </mat-card>
                </mat-step>
                <mat-step>
                    <ng-template matStepLabel>Hoàn thành</ng-template>
                    <span>Còn bước cuối cùng, nhấn Ok để thực hiện.</span>
                    <div>
                        <button mat-raised-button matStepperPrevious class="mr-left-5">Trở lại</button>
                        <button mat-raised-button color="primary" class="mr-left-5" [disabled]="form.invalid || formPondPrepare.invalid || formDetailPrepare.invalid" (click)="onSubmit()">Ok</button>
                        <button mat-raised-button color="warn" (click)="stepper.reset()" class="mr-left-5">Hủy</button>
                    </div>
                </mat-step>
            </mat-horizontal-stepper>
        </div>
    </div>
</mat-card>